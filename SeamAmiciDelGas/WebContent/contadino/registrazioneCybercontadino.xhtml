<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    template="/layout/template.xhtml">

<ui:define name="body">

	<h:form id="registrazioneCybercontadinoForm">

    <rich:panel>
        <f:facet name="header">Richiesta registrazione: Passo 1 - Dati Azienda</f:facet>
        
        <s:decorate id="partitaIvaField" template="/layout/edit.xhtml">
                <ui:define name="label">Partita IVA</ui:define>
                <h:inputText id="partitaIva"
                       required="true"
                       requiredMessage="Inserire la partita IVA"
                           size="32"
                      maxlength="11"
                      minlength='11'
                      value="#{newCybercontadino.partitaIva}">
                    <a:support event="onblur" 
                    reRender="partitaIvaField" 
                    action="#{newControlloBean.controllaPartitaIva()}"
                    ajaxSingle="true"/>   
                </h:inputText>
                <h:outputText value="#{newControlloBean.myResponsePartitaIva}" 
                style="color:red;" />
                
            </s:decorate>

			<s:decorate id="nomeAziendaField" template="/layout/edit.xhtml">
                <ui:define name="label">Nome Azienda</ui:define>
                <h:inputText id="nomeAzienda"
                       required="true"
                       requiredMessage="Inserire il nome dell'azienda"
                           size="32"
                      maxlength="50"
                          value="#{newCybercontadino.nomeAzienda}">
                    <a:support event="onblur" reRender="nomeAziendaField" bypassUpdates="true" ajaxSingle="true"/>
                </h:inputText>
            </s:decorate>


            <s:decorate id="nomePresidenteField" template="/layout/edit.xhtml">
                <ui:define name="label">Nome Presidente</ui:define>
                <h:inputText id="nomePresidente"
                       required="true"
                       requiredMessage="Inserire il nome del presidente dell'azienda"
                           size="32"
                      maxlength="50"
                          value="#{newCybercontadino.nomePresidente}">
                    <a:support event="onblur" reRender="nomePresidenteField" bypassUpdates="true" ajaxSingle="true"/>
                </h:inputText>
            </s:decorate>
            
            <s:decorate id="cognomePresidenteField" template="/layout/edit.xhtml">
                <ui:define name="label">Cognome Presidente</ui:define>
                <h:inputText id="cognomePresidente"
                       required="true"
                       requiredMessage="Inserire il cognome del presidente dell'azienda"
                           size="32"
                      maxlength="50"
                          value="#{newCybercontadino.cognomePresidente}">
                    <a:support event="onblur" reRender="cognomePresidenteField" bypassUpdates="true" ajaxSingle="true"/>
                </h:inputText>
            </s:decorate>
			
			<s:decorate id="provinciaField" template="/layout/edit.xhtml">
                <ui:define name="label">Provincia Sede Azienda</ui:define>
                <h:selectOneMenu 
                	id="provinciaSelect"
                	value="#{newComuneProvinciaBean.provincia}"
                	required="true"
                	requiredMessage="Inserire la provincia della sede dell'azienda"
                	>
                 <a:support event="onchange" ajaxSingle="true" reRender="provinciaField" 
                 />
          
                <s:selectItems 
                	noSelectionLabel="Seleziona una provincia"
                	var="_provinciaResidenza" 
                	hideNoSelectionLabel="false"
                	label="#{_provinciaResidenza.nome}" 
                	value="#{provincesList.resultList}">
                </s:selectItems>
                <s:convertEntity></s:convertEntity>
                </h:selectOneMenu>
             </s:decorate>
			
			
			<s:decorate id="comuneSuggestionField" template="/layout/edit.xhtml">
                <ui:define name="label">Comune Sede Azienda (suggestion box)</ui:define>
                <h:inputText 
                	id="comuneSuggestion"
                	size="32"
               		value="Seleziona prima una provincia"
               		required="true"
               		requiredMessage="Inserire il comune dove risiede l'azienda"
               		onclick="resetValue()"
               >
                </h:inputText>
                <script type="text/javascript">
				<!--
					function resetValue(){
						document.getElementById('registrazioneCybercontadinoForm:comuneSuggestionField:comuneSuggestion').value="";
					}
				//-->
				</script>
             <rich:suggestionbox id="suggestionBoxId"
             	 	nothingLabel="Nessun comune trovato per la provincia selezionata"
             		usingSuggestObjects="true"
             		suggestionAction="#{newComuneProvinciaBean.autocomplete}" var="_comuneSugg"
                    for="comuneSuggestion" fetchValue="#{_comuneSugg.nome}" tokens=",[]"
                    >
                    <a:support event="onselect" ajaxSingle="true"  
                 	action="#{newComuneProvinciaBean.setComune(_comuneSugg)}"/>
                 <s:convertEntity></s:convertEntity>
                    <h:column>
                        <h:outputText value="#{_comuneSugg.nome}" />
                    </h:column>
             </rich:suggestionbox>  
            
             </s:decorate>
			
            <s:decorate id="indirizzoField" template="/layout/edit.xhtml">
                <ui:define name="label">Indirizzo</ui:define>
                <h:inputText id="indirizzo"
                       required="true"
                       requiredMessage="Inserire l'indirizzo dell'azienda"
                           size="32"
                      maxlength="100"
                          value="#{newCybercontadino.indirizzo}">
                    <a:support event="onblur" reRender="indirizzoField" bypassUpdates="true" ajaxSingle="true"/>
                </h:inputText>
            </s:decorate>

	
            <s:decorate id="recapitoTelefonicoField" template="/layout/edit.xhtml">
                <ui:define name="label">Recapito Telefonico</ui:define>
                <h:inputText id="recapitoTelefonico"
                       required="true"
                       requiredMessage="Inserire il recapito telefonico per l'azienda"
                           size="32"
                      maxlength="45"
                          value="#{newCybercontadino.recapitoTelefonico}">
                    <a:support event="onblur" reRender="recapitoTelefonicoField" bypassUpdates="true" ajaxSingle="true"/>
                </h:inputText>
            </s:decorate>


            <s:decorate id="emailField" template="/layout/edit.xhtml">
                <ui:define name="label">Email</ui:define>
                <h:inputText id="email"
                       required="true"
                       requiredMessage="Inserire un'email valida per confermare la registrazione"
                           size="32"
                      maxlength="70"
                          value="#{newCybercontadino.email}">
                    <a:support event="onblur"  reRender="emailField" bypassUpdates="true" ajaxSingle="true"/>
                </h:inputText>
            </s:decorate>

			<div style="clear:both">
                <span class="required">*</span>
                Campi Richiesti
            </div>

	</rich:panel>


            <h:commandButton id="passo1" value="procedi al passo2" action="#{newControlloBean.action}"/>

     </h:form>

</ui:define>

</ui:composition>
