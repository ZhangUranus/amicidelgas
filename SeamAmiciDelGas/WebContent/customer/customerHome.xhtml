<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    template="/layout/template.xhtml">

    <ui:define name="body">
    	<div id="shadow_focus_home" style="background: transparent url('/SeamAmiciDelGas/img/shadow0.png') ; width:100%; z-index:199; height:100%; left:0; top:0; display:none; position:fixed;" />
		<div id="alert_div_focus" style="cursor:pointer; display:block; z-index: 200; position:fixed; left:40%; top:40%;" onclick="show_focus(); show_focus_timer();">
			<table width="200px" border="0" cellspacing="0" cellpadding="0" align="center" >
			  <tr>
			    <td width="13" height="12" background="/SeamAmiciDelGas/img/shadow_corner_a.png"></td>
			    <td height="12" background="/SeamAmiciDelGas/img/shadow_top_n.png"></td>
			    <td width="13" height="12" background="/SeamAmiciDelGas/img/shadow_corner_b.png"></td>
			  </tr>
			  <tr>
			  	<td background="/SeamAmiciDelGas/img/shadow_ovest.png"></td>
			    <td background="/SeamAmiciDelGas/img/shadow_n.png" valign="top"><div align="center" >
					<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/alert.png"/>
			    </div></td>
			    <td background="/SeamAmiciDelGas/img/shadow_est.png"></td>
			  </tr>
			  <tr>
			  	<td background="/SeamAmiciDelGas/img/shadow_ovest.png"></td>			    
			    <td background="/SeamAmiciDelGas/img/shadow_n.png" valign="bottom"><div align="center" class="colore_yellow">Avviso</div></td>
			    <td background="/SeamAmiciDelGas/img/shadow_est.png"></td>			      
			  </tr>
			  <tr>
			  	<td background="/SeamAmiciDelGas/img/shadow_ovest.png"></td>
			    <td background="/SeamAmiciDelGas/img/shadow_n.png" valign="top"><div align="center" class="explorer_white">
					Attenzione: hai #{filtraNotifica.numberOfHighestPriorityTaskForSingle()} avviso/i ad alta priorita' da risolvere
			    </div></td>
			    <td background="/SeamAmiciDelGas/img/shadow_est.png"></td>
			  </tr>
			  <tr>
			    <td width="13" height="12" background="/SeamAmiciDelGas/img/shadow_corner_d.png"></td>
			    <td height="12" background="/SeamAmiciDelGas/img/shadow_bottom_n.png"></td>
			    <td width="13" height="12" background="/SeamAmiciDelGas/img/shadow_corner_c.png"></td>
			  </tr>
			</table>
		</div>

		<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" >
			<tr>
				<td colspan="3">
					<table width="99%" border="0" cellspacing="6" cellpadding="0" align="left" >
					  <tr>			    
					    <td rowspan="2" width="20%" align="left">
					    	<s:decorate rendered="#{loginSelectBean.calculateMaxRole()=='admin'}"><img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/admin.png"/></s:decorate>
					    	<s:decorate rendered="#{loginSelectBean.calculateMaxRole()=='mediatore'}"><img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/contatti.png"/></s:decorate>
					    	<s:decorate rendered="#{loginSelectBean.calculateMaxRole()=='utenteGas'}"><img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/contatti.png"/></s:decorate>
					    </td>
					    <td valign="bottom" width="40%"><div align="left" class="colore_1">Bentornato <b>#{currentUser.nome} #{currentUser.cognome}</b></div></td>			      
					  	<td valign="bottom" width="40%">
					  		<s:decorate rendered="#{(currentAccount.punteggioFeedback >= 2.5)}">
					  			<div align="center" class="min_bold" onclick="javascript:infolevel();" style="cursor: pointer" >
					  			<img src="/SeamAmiciDelGas/img/driver_mini.png" border="0" id="plus_img_infolevel" align="middle" /> Proponiti come driver
					  			</div>
					  		</s:decorate>
					  	</td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">
					    	<h:graphicImage value="/img/star_full.png" rendered="#{currentAccount.punteggioFeedback > 0.5}" />
							<h:graphicImage value="/img/star_full.png" rendered="#{currentAccount.punteggioFeedback > 1.5}" />
							<h:graphicImage value="/img/star_full.png" rendered="#{currentAccount.punteggioFeedback > 2.5}" />
							<h:graphicImage value="/img/star_full.png" rendered="#{currentAccount.punteggioFeedback > 3.5}" />
							<h:graphicImage value="/img/star_full.png" rendered="#{currentAccount.punteggioFeedback > 4.5}" />
							<h:graphicImage value="/img/star_half.png" rendered="#{currentAccount.punteggioFeedback == 0.5}" />
							<h:graphicImage value="/img/star_half.png" rendered="#{currentAccount.punteggioFeedback == 1.5}" />
							<h:graphicImage value="/img/star_half.png" rendered="#{currentAccount.punteggioFeedback == 2.5}" />
							<h:graphicImage value="/img/star_half.png" rendered="#{currentAccount.punteggioFeedback == 3.5}" />
							<h:graphicImage value="/img/star_half.png" rendered="#{currentAccount.punteggioFeedback == 4.5}" />
							<h:graphicImage value="/img/star_empty.png" rendered="#{!(currentAccount.punteggioFeedback > 0)}" />
							<h:graphicImage value="/img/star_empty.png" rendered="#{!(currentAccount.punteggioFeedback > 1)}" />
							<h:graphicImage value="/img/star_empty.png" rendered="#{!(currentAccount.punteggioFeedback > 2)}" />
							<h:graphicImage value="/img/star_empty.png" rendered="#{!(currentAccount.punteggioFeedback > 3)}" />
							<h:graphicImage value="/img/star_empty.png" rendered="#{!(currentAccount.punteggioFeedback > 4)}" />
							<li>Codice fiscale: #{currentUser.codiceFiscale}</li>                        	
                        	<li>Data Attivazione: <b>#{currentAccount.dataAccettazione}</b></li>
                        	<hr noshade="noshade" width="85%" align="left"/>
                        	<span class="colore_1">I tuoi contatti</span>
                        	<li>E-mail: #{currentUser.email}</li>
                        	<li>Telefono: #{currentUser.recapitoTelefonico}</li>
                        	<li>Indirizzo: #{currentUser.indirizzo}</li>
						</div></td>
						<td valign="top"><div align="left" class="explorer">
							<s:decorate rendered="#{(currentAccount.punteggioFeedback >= 2.5)}">
                       		<table width="100%" border="0" align="left" cellpadding="0" cellspacing="0" id="table_show_info" style="display:none;">
							  <tr>
							    <td width="22" height="22" background="/SeamAmiciDelGas/img/shadow_a.png"></td>
							    <td height="22" background="/SeamAmiciDelGas/img/shadow_top.png"></td>
							    <td width="22" height="22" background="/SeamAmiciDelGas/img/shadow_b.png"></td>
							  </tr>
						      <tr>
							  	<td background="/SeamAmiciDelGas/img/shadow_left.png"></td>
							    <td background="/SeamAmiciDelGas/img/shadow.png" align="center" >
						    				<h:inputTextarea value="" />
							    </td>
							  	<td background="/SeamAmiciDelGas/img/shadow_right.png"></td>
							  </tr>
							  <tr>
							  	<td background="/SeamAmiciDelGas/img/shadow_left.png"></td>
							    <td background="/SeamAmiciDelGas/img/shadow.png" align="center">							    	
				    				<s:button rendered="#{(currentAccount.punteggioFeedback >= 2.5)}"
                	    							action="#{notificaRichiestaRisposta.notificaRequest()}" 
                   	    							value="Proponiti come driver" />
                       	    					
							    </td>
							  	<td background="/SeamAmiciDelGas/img/shadow_right.png"></td>
							  </tr>
							  <tr>
							    <td width="22" height="22" background="/SeamAmiciDelGas/img/shadow_d.png"></td>
							    <td height="22" background="/SeamAmiciDelGas/img/shadow_bottom.png"></td>
							    <td width="22" height="12" background="/SeamAmiciDelGas/img/shadow_c.png"></td>
							  </tr>
							</table>
                        	</s:decorate>
                        	<!-- Inserire il corpo del messaggio e il destinatario e il broadcast(true) come campi nascosti
                        	<h:outputText rendered="#{(currentAccount.punteggioFeedback > 3.5)}"  >
                        		Proponiti come driver <img src="/SeamAmiciDelGas/img/driver_mini.png" border="0" align="middle"/>
                        	</h:outputText>
                        	 -->
						</div></td>
					  </tr>
					</table>	
				</td>
				<td >
					<table width="99%" border="0" cellspacing="6" cellpadding="0" align="left" >
					  <tr>			    
					    <td width="50px" rowspan="2" align="left">
					    	<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/ruoli.png"/>					    	
					    </td>
					    <td valign="bottom"><div align="left" class="colore_1">I tuoi ruoli</div></td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">
							<a:repeat var="_ruolo" value="#{rolesPerAccount.resultList}">
							<h:outputText value="#{_ruolo.name}"/>; 
							</a:repeat>
					    </div></td>
					  </tr>
					</table>
					<table width="99%" border="0" cellspacing="6" cellpadding="0" align="left" >
					  <tr>			    
					    <td width="50px" rowspan="2" align="left">
					    	<s:link view="/customer/editDati.xhtml"
				             propagation="none"
				                      id="utenteEditImg"
				                rendered="#{empty from}">
				                <f:param name="utenteCodiceFiscale"
				                        value="#{currentUser.codiceFiscale}"/>
				                <f:param name="accountUsername"
				                        value="#{currentAccount.username}"/>
					    	<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/profilo.png"/>
					    	</s:link>
					    	</td>
					    <td valign="bottom"><div align="left" class="colore_1">
					    	<s:link view="/customer/editDati.xhtml"
				                   value="Profilo"
				             propagation="none"
				                      id="utenteEdit2"
				                rendered="#{empty from}">
				                <f:param name="utenteCodiceFiscale"
				                        value="#{currentUser.codiceFiscale}"/>
				                <f:param name="accountUsername"
				                        value="#{currentAccount.username}"/>
				            </s:link>
					    	</div></td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">
					    	<h:outputText value="Visualizza e modifica i tuoi dati, cancella il tuo account" rendered="#{!(loginSelectBean.calculateMaxRole()=='admin')}" />
					    	<h:outputText value="Visualizza e modifica i tuoi dati" rendered="#{(loginSelectBean.calculateMaxRole()=='admin')}"/>
					    </div></td>
					  </tr>
					</table>
					<table width="99%" border="0" cellspacing="6" cellpadding="0" align="left" >
					  <tr>			    
					    <td width="50px" rowspan="2" align="left">
					    	<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/fondo.png"/>					    	
					    </td>
					    <td valign="bottom"><div align="left" class="colore_1">Il tuo fondo soldi</div></td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">#{currentAccount.fondo} &#8364;</div>
					    </td>
					  </tr>
					</table>
					<s:decorate rendered="#{(filtraNotifica.numberOfHighestPriorityTaskForSingle() > -1)}">
						<div id="alert_div">
							<script type="text/javascript">show_focus();</script>
							<table width="99%" border="0" cellspacing="6" cellpadding="0" align="left" >
							  <tr>			    
							    <td width="50px" rowspan="2" align="left">
							    	<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/alert.png"/>					    	
							    </td>
							    <td valign="bottom"><div align="left" class="colore_1">Avviso</div></td>			      
							  </tr>
							  <tr>
							    <td valign="top"><div align="left" class="explorer">
									Hai #{filtraNotifica.numberOfHighestPriorityTaskForSingle()} avviso/i ad alta priorita' da risolvere
							    </div></td>
							  </tr>
							</table>
						</div>
					</s:decorate>					
				</td>
			</tr>
			<tr>
				<td colspan="4" height="16"><hr noshade="noshade" />	
				</td>
			</tr>
			<tr>
				<td width="25%">
					<div align="center" >TODO notifiche ed eventi
						<rich:dataTable  id="requestTable" var="_task"
									value="#{pooledTaskInstanceList}"
							rendered="#{identity.loggedIn and not empty pooledTaskInstanceList}">
							<h:column>
								<f:facet name="header">Message</f:facet>
												#{_task.variables.notifyMessageRequest.content}
									</h:column>
							<h:column>
								<f:facet name="header">Action</f:facet>
								<s:link action="#{inviaRequestReply.riceviMessaggio}" taskInstance="#{_task}"
									value="Invia Utente" />
							</h:column>
							<h:column>
								<f:facet name="header">Message</f:facet>
												#{_task.variables.notifyMessageReply.content}
									</h:column>
							<h:column>
								<f:facet name="header">Action</f:facet>
								<s:link action="#{inviaRequestReply.riceviRisposta}" taskInstance="#{_task}"
									value="Invia RICEVI RISPOSTA Utente" />
							</h:column>
							<h:column>
								<f:facet name="header">Message</f:facet>
												#{_task.variables.notificaUtente.content}
									</h:column>
									<h:column>
								<f:facet name="header">Action</f:facet>
								<s:link action="#{inviaNotificaRegistrazioni.partecipa_alla_visita}" taskInstance="#{_task}"
									value="Accetta Visita" />
							</h:column>
						</rich:dataTable>
						<rich:dataTable  id="requestTableFalsa" var="_task2"
									value="#{taskInstanceList}"
							rendered="#{identity.loggedIn and not empty taskInstanceList}">
							<h:column>
								<f:facet name="header">Message</f:facet>
												#{_task2.variables.notifyMessageRequest.content}
									</h:column>
							<h:column>
								<f:facet name="header">Action</f:facet>
								<s:link action="#{inviaRequestReply.riceviMessaggio}" taskInstance="#{_task2}"
									value="Invia Ricevi Messaggio" />
							</h:column>
							<h:column>
								<f:facet name="header">Message</f:facet>
												#{_task2.variables.notifyMessageReply.content}
									</h:column>
							<h:column>
								<f:facet name="header">Action</f:facet>
								<s:link action="#{inviaRequestReply.riceviRisposta}" taskInstance="#{_task2}"
									value="Invia RICEVI RISPOSTA" />
							</h:column>
						</rich:dataTable>
									<li>notifica1</li>
                        	
								</div>
				</td>
				
				<td width="25%">
					<table width="98%" border="0" cellspacing="6" cellpadding="0" align="center" >
					  <tr>			    
					    <td rowspan="2" align="left"><a href="/SeamAmiciDelGas/driver/itinerario.seam"><img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/itinerario.png"/></a></td>
					    <td valign="bottom"><div align="left" class="colore_1"><a href="/SeamAmiciDelGas/driver/itinerario.seam">itinerario</a></div></td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">Crea un nuovo itinerario di visita</div></td>
					  </tr>
					</table>
				</td>
				<td width="25%">
					<s:decorate rendered="#{(loginSelectBean.calculateMaxRole()=='mediatore') or (loginSelectBean.calculateMaxRole()=='admin')}">
						<table width="98%" border="0" cellspacing="6" cellpadding="0" align="center" >
						  <tr>			    
						    <td rowspan="2" align="left"><a href="/SeamAmiciDelGas/mediatore/puntiDiConsegna.seam"><img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/punto_consegna.png"/></a></td>
						    <td valign="bottom"><div align="left" class="colore_1"><a href="/SeamAmiciDelGas/mediatore/puntiDiConsegna.seam">Punti di consegna</a></div></td>			      
						  </tr>
						  <tr>
						    <td valign="top"><div align="left" class="explorer">Aggiungi, Modifica, Elimina i Punti di Consegna </div></td>
						  </tr>
						</table>					
					</s:decorate>
				</td>
				<td width="25%">

				</td>
			</tr>
		
		<s:decorate rendered="#{loginSelectBean.calculateMaxRole()=='admin'}">	
			<tr>
			<td width="25%">
					<table width="98%" border="0" cellspacing="6" cellpadding="0" align="center" >
					  <tr>			    
					    <td rowspan="2" align="left">
					    	<s:link view="/admin/editDatiUtenti.xhtml"
				             propagation="none"
				                      id="editDatiUtentiRegistratiImg"
				                rendered="#{empty from}">
				                <f:param name="utenteCodiceFiscale"
				                        value="#{currentUser.codiceFiscale}"/>
				                <f:param name="accountUsername"
				                        value="#{currentAccount.username}"/>
					    	<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/customer40x50.jpg"/>
					    	</s:link>
					    	</td>
					    <td valign="bottom"><div align="left" class="colore_1">
					    	<s:link view="/admin/editDatiUtenti.xhtml"
				                   value="Utenti registrati"
				             propagation="none"
				                      id="editDatiUtentiRegistrati2"
				                rendered="#{empty from}">
				                <f:param name="utenteCodiceFiscale"
				                        value="#{currentUser.codiceFiscale}"/>
				                <f:param name="accountUsername"
				                        value="#{currentAccount.username}"/>
				            </s:link>
					    	</div></td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">Visualizza e modifica i dati degli utenti</div></td>
					  </tr>
					</table>
				</td>
			
			<td width="25%">
					<table width="98%" border="0" cellspacing="6" cellpadding="0" align="center" >
					  <tr>			    
					    <td rowspan="2" align="left">
					    	<s:link view="/admin/editDatiCybercontadino.xhtml"
				             propagation="none"
				                      id="editDatiCybercontadiniRegistratiImg"
				                rendered="#{empty from}">
				                <f:param name="utenteCodiceFiscale"
				                        value="#{currentUser.codiceFiscale}"/>
				                <f:param name="accountUsername"
				                        value="#{currentAccount.username}"/>
					    	<img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/contadini_registrati.png"/>
					    	</s:link>
					    	</td>
					    <td valign="bottom"><div align="left" class="colore_1">
					    	<s:link view="/admin/editDatiCybercontadino.xhtml"
				                   value="Cybercontadini registrati"
				             propagation="none"
				                      id="editDatiCybercontadiniRegistrati2"
				                rendered="#{empty from}">
				                <f:param name="utenteCodiceFiscale"
				                        value="#{currentUser.codiceFiscale}"/>
				                <f:param name="accountUsername"
				                        value="#{currentAccount.username}"/>
				            </s:link>
					    	</div></td>			      
					  </tr>
					  <tr>
					    <td valign="top"><div align="left" class="explorer">Visualizza e modifica i dati dei cybercontadini</div></td>
					  </tr>
					</table>
				</td>
			</tr>
		</s:decorate>	
			
		</table>		

    </ui:define>
</ui:composition>
