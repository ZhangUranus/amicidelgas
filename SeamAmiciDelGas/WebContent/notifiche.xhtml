<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    template="/layout/template.xhtml">

	<ui:define name="body">
		
		<h:form id="inviaNotifica" styleClass="edit">
			<rich:simpleTogglePanel label="Invia Notifica" switchType="ajax">
			<h:panelGrid columns="1">	
				<s:decorate id="destinatarioField" template="/layout/edit.xhtml">
				
	                <ui:define name="label">Scegli il destinatario</ui:define>
	                <h:selectOneRadio value="#{notificaBean.destinatario}" required="true" requiredMessage="Scegli il destinatario">
					  <a:support event="onclick" ajaxSingle="true" reRender="gruppoField, utenteField">	</a:support>
					  <f:selectItem itemLabel="Gruppo" itemValue="gruppo" />
	  				  <f:selectItem itemLabel="Utente" itemValue="utente" />
					</h:selectOneRadio>
	            </s:decorate>
				
				<a:outputPanel ajaxRendered="true">
					<s:decorate id="gruppoField" rendered="#{notificaBean.destinatario=='gruppo'}">
						<h:selectOneMenu value="#{notificaBean.gruppoScelto}"  required="true"  requiredMessage="Seleziona il gruppo a cui vuoi inviare una notifica">
		                	<f:selectItem itemDisabled="true"   itemLabel="Select-one"/>
		                	<f:selectItem itemLabel="Utente Gas" itemValue="utenteGas"/>
		                	<f:selectItem itemLabel="Cyber Contadino" itemValue="utenteContadino" />
						  	<f:selectItem itemLabel="Mediatore" itemValue="mediatore" />
						  	<f:selectItem itemLabel="Admin" itemValue="admin" />
		                </h:selectOneMenu>
					</s:decorate>
				</a:outputPanel>
				
				<a:outputPanel ajaxRendered="true">
					<s:decorate id="utenteField" rendered="#{notificaBean.destinatario=='utente'}">
						
			<f:facet name="header">Lista utenti</f:facet>
		   		<div class="results" id="listaUtenti">
				<h:form>
			        <a:region>
				    <rich:dataTable id="myUtentiList"
				                var="_accountVar"
				                value="#{accountListExtended.resultList}"
				              rendered="#{not empty accountListExtended.resultList}"
				              rows="5"
				              rowKeyVar="row">
			    				              
				     <rich:column>          
					     <f:facet name="header">
				                <ui:include src="/layout/sort.xhtml">
				                    <ui:param name="entityList" value="#{accountListExtended}"/>
				                    <ui:param name="propertyLabel" value="Username"/>
				                    <ui:param name="propertyPath" value="account.username"/>
				                </ui:include>
				          </f:facet>         
				          <h:outputText value="#{_accountVar.username}"/>
			         </rich:column>
			         
			         <rich:column>          
					     <f:facet name="header">
				                <ui:include src="/layout/sort.xhtml">
				                    <ui:param name="entityList" value="#{accountListExtended}"/>
				                    <ui:param name="propertyLabel" value="Cognome"/>
				                    <ui:param name="propertyPath" value="account.utente.cognome"/>
				                </ui:include>
				          </f:facet>         
				          <h:outputText value="#{_accountVar.utente.cognome}"/>
			         </rich:column>
			         
			         <rich:column>
			            <f:facet name="header">
			                <ui:include src="/layout/sort.xhtml">
			                    <ui:param name="entityList" value="#{accountListExtended}"/>
			                    <ui:param name="propertyLabel" value="Nome"/>
			                    <ui:param name="propertyPath" value="account.utente.nome"/>
			                </ui:include>
			            </f:facet>
			            <h:outputText value="#{_accountVar.utente.nome}"/>
			        </rich:column>        

			        <rich:column>
			            <f:facet name="header">Stato</f:facet>
			               <div align="center">
								<h:graphicImage id="nonCancellato" value="/img/customer40x50.jpg" rendered="#{!_accountVar.elimato}" width="30%"/>
									<rich:toolTip for="nonCancellato" value="Utente non cancellato"/>
								<h:graphicImage id="cancellato" value="/img/customer40x50eliminato.jpg" rendered="#{_accountVar.elimato}" width="30%"/>
									<rich:toolTip for="cancellato" value="Utente cancellato"/>
						   </div>
			        </rich:column>
			         
			        <rich:column align="center">
			            <f:facet name="header">Select</f:facet>
			                <a:commandLink id="selezionaUtenteLink" ajaxSingle="true" 
			                rendered="myUtentiListSelezionati">
								<h:graphicImage id="cancellato2" value="/img/customer40x50eliminato.jpg" rendered="#{_accountVar.elimato}" width="30%"/>
							<f:setPropertyActionListener value="#{_accountVar}" 
				            							 target="#{notificaBean.utenteScelto}" />
							
							</a:commandLink>
				            <rich:toolTip for="selezionaUtenteLink" value="Invia notifica all'utente" rendered="#{!_accountVar.elimato}"/>
			        </rich:column>
			        
				  </rich:dataTable>
				  <rich:datascroller align="center" for="myUtentiList" id="sc1" rendered="true"/>
				  </a:region>
				  </h:form>
			    </div>
						
				<s:decorate>
					<rich:dataTable id="myUtentiListSelezionati"
				                var="_utenti"
				                value="#{notificaBean.accountList}"
				              rendered="#{not empty notificaBean.accountList}"
				              rows="5"
				              rowKeyVar="row">
				              
				              <rich:column>
				              		<h:outputText value="#{_utenti.username}"/>
				              </rich:column>
				              
					</rich:dataTable>
				</s:decorate>	
						
					</s:decorate>
				</a:outputPanel>
				
				
				
				 <h:inputText id="messaggio"
	                       required="true"
	                           size="32"
	                      maxlength="70"
	                          value="#{notificaBean.messaggio}"/>
			</h:panelGrid>
			</rich:simpleTogglePanel>
			
		</h:form>
		<br/>
		<br/>
		<h:form id="notificheRicevute" styleClass="edit">
			<rich:simpleTogglePanel label="Notifiche Ricevute" switchType="ajax">
			
				
			</rich:simpleTogglePanel>	
			
			
		</h:form>
		
		
	</ui:define>
	
</ui:composition>
