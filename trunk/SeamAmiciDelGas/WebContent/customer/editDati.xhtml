<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a="http://richfaces.org/a4j"
    template="/layout/template.xhtml">

	<ui:define name="body">
	
	<table width="96%" border="0" cellspacing="0" cellpadding="0" align="center" >
		<tr>
			<td width="45%" align="center">
				<table width="100%" border="0" cellspacing="4" cellpadding="0" align="center" >
				  <tr>			    
				    <td valign="top"><div align="center" ><b>Riepilogo dati personali</b></div></td>			      
				  </tr>
				  <tr>			    
				    <td width="160" align="center"><a href="categories"><img alt="statistiche" border="0" src="/SeamAmiciDelGas/img/contatti.png"/></a></td>
				  </tr>
				  <tr>			    
					<td valign="top"><div align="center" >
						<h:graphicImage value="/img/star_full.png" rendered="#{accountHome.instance.punteggioFeedback > 0.5}" />
						<h:graphicImage value="/img/star_full.png" rendered="#{accountHome.instance.punteggioFeedback > 1.5}" />
						<h:graphicImage value="/img/star_full.png" rendered="#{accountHome.instance.punteggioFeedback > 2.5}" />
						<h:graphicImage value="/img/star_full.png" rendered="#{accountHome.instance.punteggioFeedback > 3.5}" />
						<h:graphicImage value="/img/star_full.png" rendered="#{accountHome.instance.punteggioFeedback > 4.5}" />
						<h:graphicImage value="/img/star_half.png" rendered="#{accountHome.instance.punteggioFeedback == 0.5}" />
						<h:graphicImage value="/img/star_half.png" rendered="#{accountHome.instance.punteggioFeedback == 1.5}" />
						<h:graphicImage value="/img/star_half.png" rendered="#{accountHome.instance.punteggioFeedback == 2.5}" />
						<h:graphicImage value="/img/star_half.png" rendered="#{accountHome.instance.punteggioFeedback == 3.5}" />
						<h:graphicImage value="/img/star_half.png" rendered="#{accountHome.instance.punteggioFeedback == 4.5}" />
						<h:graphicImage value="/img/star_empty.png" rendered="#{!(accountHome.instance.punteggioFeedback > 0)}" />
						<h:graphicImage value="/img/star_empty.png" rendered="#{!(accountHome.instance.punteggioFeedback > 1)}" />
						<h:graphicImage value="/img/star_empty.png" rendered="#{!(accountHome.instance.punteggioFeedback > 2)}" />
						<h:graphicImage value="/img/star_empty.png" rendered="#{!(accountHome.instance.punteggioFeedback > 3)}" />
						<h:graphicImage value="/img/star_empty.png" rendered="#{!(accountHome.instance.punteggioFeedback > 4)}" />
					</div></td>
				  </tr>				  
				</table>
			</td>
			<td width="10%">
			</td>
			<td width="45%">
				<div class="colore_1" align="center">Modifica Contatti</div>
				<h:form>
			        <a:region>
					<rich:dataTable value="#{utenteHome.instance}" var="_dati" id="table" width="80%">
							<rich:column >
								<f:facet name="header">
									<h:outputText value="E-mail" />
								</f:facet>
								<h:outputText value="#{_dati.email}" id="email" />
			        		</rich:column>
			        			
			        		<rich:column>
								<f:facet name="header">
									<h:outputText value="Indirizzo" />
								</f:facet>
								<h:outputText value="#{_dati.indirizzo}" id="indirizzo" />
			        		</rich:column>
			        		
			        		<rich:column>
								<f:facet name="header">
									<h:outputText value="Telefono" />
								</f:facet>
								<h:outputText value="#{_dati.recapitoTelefonico}" id="telefono" />
			        		</rich:column>
			        		
			        		<rich:column align="center">
				                <f:facet name="header">
				                        Azioni
				                </f:facet>
				                <a:commandLink ajaxSingle="true" id="editlink"
				                    oncomplete="#{rich:component('editPanel')}.show()">
				                    <h:graphicImage value="/img/modifica_mini.png" style="border:0"/>
				                </a:commandLink>
				                <rich:toolTip for="editlink" value="Modifica Recapiti"/>
				            </rich:column>     			
					</rich:dataTable>
					</a:region>
			    </h:form>
			</td>
		</tr>
		<tr>
			<td colspan="3" height="16"></td>
		</tr>
		<tr>
			<td width="45%">
				<span id="riepilogoDati">
					<li>Codice fiscale: #{utenteHome.instance.codiceFiscale}</li>
	                <li>Punteggio feedback: <b></b> </li>
	                <li>Data Richiesta Account: <b><h:outputText value="#{accountHome.instance.dataRichiesta}">
							<f:convertDateTime type="date" dateStyle="medium" locale="Locale.ITALY"/>
						</h:outputText></b></li>
	                <li>Data Attivazione Account: <b>#{accountHome.instance.dataAccettazione}</b></li>
					<li>E-mail: #{utenteHome.instance.email}</li>
	                <li>Telefono: #{utenteHome.instance.recapitoTelefonico}</li>
	                <li>Indirizzo: #{utenteHome.instance.indirizzo}</li>
	                <li>Tipo di carta: #{accountHome.instance.pagamentoelettronico.tipoCarta}</li>
	                <li>Numero della carta: #{accountHome.instance.pagamentoelettronico.numeroCarta}</li>
                </span>
			</td>
			<td width="10%">
			</td>
			<td width="45%">
				<div class="colore_1" align="center">Modifica Dati Pagamento</div>
				<h:form>
			        <a:region>
					<rich:dataTable value="#{accountHome.instance}" var="_dati" id="table" width="80%">
							<rich:column >
								<f:facet name="header">
									<h:outputText value="Tipo Carta" />
								</f:facet>
								<h:outputText value="#{_dati.pagamentoelettronico.tipoCarta}" id="email" />
			        		</rich:column>
			        			
			        		<rich:column>
								<f:facet name="header">
									<h:outputText value="Numero Carta" />
								</f:facet>
								<h:outputText value="#{_dati.pagamentoelettronico.numeroCarta}" id="indirizzo" />
			        		</rich:column>
			        		
			        		<rich:column  align="center">
				                <f:facet name="header">
				                        Azioni
				                </f:facet>
				                <a:commandLink ajaxSingle="true" id="editlink"
				                    oncomplete="#{rich:component('editPagamento')}.show()">
				                    <h:graphicImage value="/img/modifica_mini.png" style="border:0"/>
				                    
				                </a:commandLink>
				                <rich:toolTip for="editlink" value="Modifica dati di pagamento"/>
				            </rich:column>     		
			        		
					</rich:dataTable>
					</a:region>
			    </h:form>
			</td>
		</tr>
	</table>
	
		<rich:modalPanel id="editPagamento" autosized="true" width="400">
	        <f:facet name="header">
	            <h:outputText value="Modifica i dati di pagamento elettronico" />
	        </f:facet>
	        <f:facet name="controls">
	            <h:panelGroup>
	                <h:graphicImage value="/img/close.png"
	                    id="hidelink0" />
	                <rich:componentControl for="editPagamento" attachTo="hidelink0"
	                    operation="hide" event="onclick" />
	            </h:panelGroup>
	        </f:facet>
	        <h:form>
	            <rich:messages style="color:red;"></rich:messages>
	            <h:panelGrid columns="1">
	            <a:outputPanel ajaxRendered="true">
	                <h:panelGrid columns="2">
	                    <h:outputText value="Tipo carta"/>
						<table><tbody>
							<tr>
								<td><input type="radio" name="#{newPagamento.tipoCarta}" id="j_id65:j_id71:0" value="Visa"/><label for="j_id65:j_id71:0"/><img align="middle" src="/SeamAmiciDelGas/img/creditcard_visa.png"/></td>
								<td><input type="radio" name="#{newPagamento.tipoCarta}" id="j_id65:j_id71:1" value="MasterCard"/><label for="j_id65:j_id71:1"/><img align="middle" src="/SeamAmiciDelGas/img/creditcard_mastercard.png"/></td>
								<td><input type="radio" name="#{newPagamento.tipoCarta}" id="j_id65:j_id71:2" value="AmericanExpress"/><label for="j_id65:j_id71:2"/><img align="middle" src="/SeamAmiciDelGas/img/creditcard_american_express.png"/></td>
								<td><input type="radio" name="#{newPagamento.tipoCarta}" id="j_id65:j_id71:3" value="PayPal"/><label for="j_id65:j_id71:3"><img align="middle" src="/SeamAmiciDelGas/img/creditcard_paypal.png"/></label></td>
							</tr>
							</tbody>
						</table> 
	                    
	                    <h:outputText value="Numero carta" />
	                    <h:inputText id="campo-numerocarta" value="#{accountHome.instance.pagamentoelettronico.numeroCarta}" required="true" size="16" maxlength="16" />
	                </h:panelGrid>
	                <rich:message showSummary="true" showDetail="false" for="campo-tipocarta"/>
	            </a:outputPanel>
	            <a:commandButton value="Salva"
	                action="#{accountHome.update()}"
	                reRender="email, indirizzo, telefono, riepilogoDati"
	                oncomplete="#{rich:component('editPagamento')}.hide();" />
	            </h:panelGrid>  
	        </h:form>
	    </rich:modalPanel>
		 
		 <rich:modalPanel id="editPanel" autosized="true" width="400">
	        <f:facet name="header">
	            <h:outputText value="Modifica i recapiti telefonici" />
	        </f:facet>
	        <f:facet name="controls">
	            <h:panelGroup>
	                <h:graphicImage value="/img/close.png"
	                    id="hidelink" />
	                <rich:componentControl for="editPanel" attachTo="hidelink"
	                    operation="hide" event="onclick" />
	            </h:panelGroup>
	        </f:facet>
	        <h:form>
	            <rich:messages style="color:red;"></rich:messages>
	            <h:panelGrid columns="1">
	            <a:outputPanel ajaxRendered="true">
	                <h:panelGrid columns="2">
	                    <h:outputText value="E-mail"/>
	                    <h:inputText id="campo-email" value="#{utenteHome.instance.email}" required="true" size="32" maxlength="70">
	                    	<a:support event="onblur" 
		                    reRender="campo-email" 
		                    action="#{newControlloBean.controllaEmail()}"
		                    ajaxSingle="true"/> 
	                    </h:inputText>
	                    <h:outputText value="Indirizzo" />
	                    <h:inputText id="campo-indirizzo" value="#{utenteHome.instance.indirizzo}" required="true" size="32" maxlength="100" />
	                    <h:outputText value="Telefono" />
	                    <h:inputText id="campo-telefono" value="#{utenteHome.instance.recapitoTelefonico}" required="true" size="32" maxlength="45"/>
	                </h:panelGrid>
	                <rich:message showSummary="true" showDetail="false" for="campo-email"/>
	            </a:outputPanel>
	            <a:commandButton value="Salva"
	                action="#{utenteHome.update()}"
	                reRender="campo-email, campo-indirizzo, campo-telefono, riepilogoDati"
	                oncomplete="#{rich:component('editPanel')}.hide();" />
	            </h:panelGrid>  
	        </h:form>
	    </rich:modalPanel> 
	
	    <a:status onstart="#{rich:component('wait')}.show()" onstop="#{rich:component('wait')}.hide()"/>
	    <rich:modalPanel id="wait" autosized="true" width="200" height="120" moveable="false" resizeable="false">
	        <f:facet name="header">
	            <h:outputText value="Processando le modifiche"/>
	        </f:facet>
	        <h:outputText value="attendere..."/>
	    </rich:modalPanel>
	    <rich:messages></rich:messages>
	
	</ui:define>

</ui:composition>