<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j" template="/layout/template.xhtml">



	<ui:define id="defineUI" name="body">
	
	<h:form id="browseContadiniForm">
		<rich:simpleTogglePanel id="simpleTogglePanelOrdini" switchType="ajax" label="Ordini">
	
				<h:selectOneRadio value="#{takeInHandForCustomer.stringa}" required="true">
                 	<a:support event="onclick" ajaxSingle="true" reRender="decoratepanelGridInfoOrdine,simpleTogglePanelCustomerToContadini,simpleTogglePanelCustomerToResponsabileConsegna"/>
               		<s:selectItems var="_stringa" label="Ordine #{_stringa}" value="#{takeInHandForCustomer.stringhe}" />
                </h:selectOneRadio>
                
            <a:outputPanel ajaxRendered="true"> 
				<s:decorate id="decoratepanelGridInfoOrdine" rendered="#{not empty takeInHandForCustomer.currentOrdine}">
                	<h:panelGrid id="panelGridInfoOrdine" columns="4" >
                		<rich:column>
							<table id="table_data_richiesta" cellpadding="10" cellspacing="0" border="0" width="100%"	>
								<tr><td>
										<b>Data Richiesta</b>
								</td></tr>
								<tr><td>
										<h:outputText value="#{takeInHandForCustomer.currentOrdine.dataRichiesta}">
											<f:convertDateTime type="date" dateStyle="medium" locale="Locale.ITALY"/>											
										</h:outputText>
								</td></tr>
							</table>
	        			</rich:column>
	        			<rich:column>
							<table id="table_data_conclusione" cellpadding="10" cellspacing="0" border="0" width="100%"	>
								<tr><td>
									<b>Data Conclusione</b>
								</td></tr>
								<tr><td>
									<h:outputText value="#{takeInHandForCustomer.currentOrdine.dataConclusione}">
										<f:convertDateTime type="date" dateStyle="medium" locale="Locale.ITALY"/>
									</h:outputText>	
								</td></tr>
							</table>
	        			</rich:column>
	        			<rich:column>
							<table id="table_data_driver" cellpadding="10" cellspacing="0" border="0" width="100%"	>
								<tr><td>
									<b>Driver</b>
								</td></tr>
								<tr><td>
									<h:outputText value="#{takeInHandForCustomer.currentOrdine.driver.username}">
									</h:outputText>	
								</td></tr>
							</table>
	        			</rich:column>
	        			<rich:column align="center">
							<table id="table_data_dettagli" cellpadding="10" cellspacing="0" border="0" width="100%"	>
								<tr><td align="center">
			                        	<b>Dettagli ordini</b>
								</td></tr>
								<tr><td align="center">
				                	<a:commandLink ajaxSingle="true" id="dettagliOrdinePendenteLink2"
				                    	oncomplete="#{rich:component('dettagliOrdinePanel')}.show()">
					                    <h:graphicImage value="/img/modifica_mini.png" style="border:0" />
					                </a:commandLink>
					                <rich:toolTip for="dettagliOrdinePendenteLink2" value="Visualizza dettagli ordine"/>
					             </td></tr>
							</table>
				        </rich:column>
                	</h:panelGrid>      
				</s:decorate>
			</a:outputPanel> 
        </rich:simpleTogglePanel>
     </h:form>
     
     <br/>
 	<br/>
 	<br/>
                
            <a:outputPanel ajaxRendered="true">   
            <rich:simpleTogglePanel id="simpleTogglePanelCustomerToContadini" switchType="ajax" label="Rilascia feedback ai contadini">    
			
				<s:decorate id="rilasciaFeedbackField1" rendered="#{not empty takeInHandForCustomer.currentTaskCustomerToContadino}">
					<h:form>
					<h:dataTable value="#{takeInHandForCustomer.listCybercontadiniEffettivi()}" var="_contadino">
							<rich:column>
									<f:facet name="header">
										<h:outputText value="Username contadino" />
									</f:facet>
									<h:outputText value="#{_contadino.account.username}"></h:outputText>
			        		</rich:column>
			        		<rich:column>
			        			<s:decorate template="/layout/edit.xhtml">
	                				<f:facet name="header">
										<h:outputText value="Voto feedback" />
									</f:facet>
	                				<h:selectOneRadio value="#{takeInHandForCustomer.getInfoFeedbackContadini(_contadino.account.username).feedback}" required="true" 
	                					requiredMessage="inserire una valutazione">
					  					<f:selectItem itemLabel="Basso" itemValue="1" ></f:selectItem>
					  					<f:selectItem itemLabel="Normale" itemValue="2" ></f:selectItem>
					  					<f:selectItem itemLabel="Alto" itemValue="3"></f:selectItem>
					  					<f:selectItem itemLabel="Utopico" itemValue="4"></f:selectItem>
					  					<f:selectItem itemLabel="Divino" itemValue="5"></f:selectItem>
					  					<a:support	event="onclick" ajaxSingle="true"/>
					  				</h:selectOneRadio>
	            				</s:decorate>
			        		</rich:column>
			        		<rich:column>
			        			<s:decorate template="/layout/edit.xhtml">
	                				<f:facet name="header">
										<h:outputText value="Commento" />
									</f:facet>
			        				<h:inputTextarea value="#{takeInHandForCustomer.getInfoFeedbackContadini(_contadino.account.username).comment}">
			        					<a:support	event="onblur" ajaxSingle="true"/>
					  				</h:inputTextarea>
			        			</s:decorate>
			        		</rich:column>
						</h:dataTable>
						<div id="pulsante_driver_loading1" style="display: none;"><img src="/GAS/img/loading.gif" /></div>	
	        			<s:button taskInstance="#{takeInHandForCustomer.currentTaskCustomerToContadino}" value="Assegna Feedback"
	        					  action="#{orderProcessing.fb_customer_to_contadino(takeInHandForCustomer)}"
	        					  onmouseup="disable_this(this.id, 'pulsante_driver_loading1');">	
	        			</s:button>
	        			
					</h:form>
				</s:decorate>

			</rich:simpleTogglePanel>
			</a:outputPanel>
		
		<br/>
 		<br/>
 		<br/>
		
		<a:outputPanel ajaxRendered="true">   
            <rich:simpleTogglePanel id="simpleTogglePanelCustomerToResponsabileConsegna" switchType="ajax" label="Rilascia feedback al responsabile consegna">    
			
				<s:decorate id="rilasciaFeedbackField2" rendered="#{not empty takeInHandForCustomer.currentTaskCustomerToResponsabileConsegna}">
					<h:form>
					<h:dataTable value="#{takeInHandForCustomer.responsabileConsegna()}" var="_responsabile">
							<rich:column>
									<f:facet name="header">
										<h:outputText value="Username responsabile" />
									</f:facet>
									<h:outputText value="#{_responsabile.username}"></h:outputText>
			        		</rich:column>
			        		<rich:column>
			        			<s:decorate template="/layout/edit.xhtml">
	                				<f:facet name="header">
										<h:outputText value="Voto feedback" />
									</f:facet>
	                				<h:selectOneRadio value="#{takeInHandForCustomer.infoFeedbackResponsabile.feedback}" required="true" 
	                					requiredMessage="inserire una valutazione">
					  					<f:selectItem itemLabel="Basso" itemValue="1" ></f:selectItem>
					  					<f:selectItem itemLabel="Normale" itemValue="2" ></f:selectItem>
					  					<f:selectItem itemLabel="Alto" itemValue="3"></f:selectItem>
					  					<f:selectItem itemLabel="Utopico" itemValue="4"></f:selectItem>
					  					<f:selectItem itemLabel="Divino" itemValue="5"></f:selectItem>
					  					<a:support	event="onclick" ajaxSingle="true"/>
					  				</h:selectOneRadio>
	            				</s:decorate>
			        		</rich:column>
			        		<rich:column>
			        			<s:decorate template="/layout/edit.xhtml">
	                				<f:facet name="header">
										<h:outputText value="Commento" />
									</f:facet>
			        				<h:inputTextarea value="#{takeInHandForCustomer.infoFeedbackResponsabile.comment}">
			        					<a:support	event="onblur" ajaxSingle="true"/>
					  				</h:inputTextarea>
			        			</s:decorate>
			        		</rich:column>
			        		
						</h:dataTable>
						<div id="pulsante_driver_loading2" style="display: none;"><img src="/GAS/img/loading.gif" /></div>	
	        			<s:button taskInstance="#{takeInHandForCustomer.currentTaskCustomerToResponsabileConsegna}" value="Assegna Feedback"
	        					  action="#{orderProcessing.fb_customer_to_responsabile_consegna(takeInHandForCustomer)}"
	        					  onmouseup="disable_this(this.id, 'pulsante_driver_loading2');">
	        			</s:button>

					
					</h:form>
				</s:decorate>

			</rich:simpleTogglePanel>
			</a:outputPanel>
	
	 	<br/>
	 	<br/>
	 	<br/>
	
	<a:outputPanel ajaxRendered="true">
		<rich:modalPanel id="dettagliOrdinePanel" autosized="true" width="350">
       		<f:facet name="header">
            	<h:outputText value="Dettagli ordini" />
        	</f:facet>
       		<f:facet name="controls">
            	<h:panelGroup>
                	<h:graphicImage value="/img/close.png" styleClass="hidelink" id="hidelink2"/>
               	 	<rich:componentControl for="dettagliOrdinePanel" attachTo="hidelink2" operation="hide" event="onclick" />
            	</h:panelGroup>
        	</f:facet>
			<ui:define name="label">Prodotti nel carrello</ui:define>
			<rich:dataTable var="_articolo" id="itemsDataTableOrdiniFatti"
				value="#{takeInHandForCustomer.articoloForCurrentOrdine}">
				<rich:column>
						<f:facet name="header">Nome prodotto</f:facet>
						<h:outputText value="#{_articolo.codiceEsterno}"/>
				</rich:column>	
				<rich:column>
					<f:facet name="header">Azienda</f:facet>
					<h:outputText value="#{_articolo.cybercontadino.nomeAzienda}"/>
				</rich:column>	
				<rich:column>
						<f:facet name="header">Quantita prodotto</f:facet>
						<h:outputText value="#{_articolo.quantitaOttenuta}"/>
				</rich:column>	
				<rich:column>
						<f:facet name="header">Totale per prodotto</f:facet>
						<h:outputText value="#{_articolo.quantitaOttenuta * _articolo.prezzo} euro"/>
				</rich:column>
			</rich:dataTable>
       	</rich:modalPanel>
     </a:outputPanel>
     
	</ui:define>

</ui:composition>

